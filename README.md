# 前端监控

## 1 为什么要做前端监控

- 更快的定位问题和解决问题

- 做产品决策的依据

- 为业务扩展提供更多可能性

## 2 前端监控的目标

### 2.1 稳定性（stability）

错误名称 | 备注
:-|:-
JS错误 | JS执行错误或Promise错误
资源异常 | script、link等资源加载异常
接口错误 | ajax或fetch请求接口异常
白屏 | 页面空白

### 2.2 用户体验

错误名称 | 备注
:-|:-
加载时间 | 各个阶段的加载时间
TTFB（time to first byte）首字节时间 | 指浏览器发起第一个请求到数据返回第一个字节所消耗的时间，这个时间包含了网络请求时间
FP（first paint）首次绘制 | 它包括了任何用户自定义的背景绘制，它是将第一个像素绘制到屏幕的时刻
FCP（first content paint） 首次内容绘制 | 指浏览器将第一个DOM绘制到屏幕的时间，可以是任何文本、图像、SVG等的时间
FMP（first meaningful paint） 首次有意义绘制 | 指页面可用性的量度标准
FID（firt input delay）首次输入延迟 | 用户首次和页面交互到页面响应交互的时间
卡顿 | 超过50ms的长任务

### 2.3 业务

错误名称 | 备注
:-|:-
PV | page view 即页面的浏览量或点击量
UV | 指访问某个站点的不同IP地址的人数
页面的停留时间 | 用户在每一个页面停留的时间

## 3 前端监控流程

### 3.1 前端埋点

#### 3.1.1 代码埋点

- 代码埋点，是以嵌入代码的形式进行埋点，比如需要监控用户的点击事件，会在用户点击的地方插入一段代码，保存这个监听行为或者直接监听行为以某种数据格式直接传递给服务器

- 优点是可以在任意时刻，精确的发送或保存所需要的数据信息

- 缺点是工作量比较大

#### 3.1.2 可视化埋点

- 通过可视化交互的手段，代替代码埋点

- 将业务代码和埋点代码分离，提供一个可视化的界面，输入业务代码，通过可视化系统，可以在业务代码中自定义的增加埋点事件等，最后输出的代码耦合了业务代码和埋点代码

- 即用系统来替代手工插入埋点代码

#### 3.1.3 无痕埋点

- 前端的任意一个事件都被绑定一个标识，所有的事件都被记录

- 通过定期上传记录文件，配合文件解析，解析出我们要的数据，并生成可视化报告供专业人员分析

- 无痕埋点的优点是采集全量数据，不会出现漏埋和误埋的情况

- 缺点是给数据传输和服务器增加了压力，并且也无法灵活的定制数据结构

### 3.2 数据上报

### 3.3 分析和计算 将采集到的数据进行加工汇总

### 3.4 可视化展示 将数据按照各种维度进行展示

### 3.5 监控报警 发现问题后按一定的条件触发报警

## 4 编写监控采集脚本

## 5 查询报表
